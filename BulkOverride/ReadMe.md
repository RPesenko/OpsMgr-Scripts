# BulkOverride.ps1
    Version: 1.0
    Release 2020/12/27
  
This script runs Export-SCOMEffectiveMonitoringConfiguration against an agent, or takes a previously generated CSV file generated by this cmdlet, and presents all the currently enabled rules and monitors in a PowerShell Gridview object.  Enabled rules and monitors can be selected from the gridview and overrides to disable the selected workflows will be created and saved to a single override MP.

## Usage:
*****Use existing file option*****  
**BulkOverride.ps1** *-ConfigFile Filepath -MP ManagementPack* *[-MS FQDN]*

[ConfigFile] = Mandatory parameter.  The full path of the configuraton file to use when generating overrides.  The script expects the configuration file to be named in either the format: _`<HostName>.csv`_ or _`<FQDN>.csv`_ and to be in the original export format generated by the _Export-SCOMEffectiveMonitoringConfiguration_ cmdlet.     
[MP] = Mandatory parameter.  Display name of the management pack where the overrides will be stored. This can either be an empty, unsealed management pack, or an existing unsealed MP with custom workflows and overrides, but the script will not create one if it does not already exist.    
[MS] = Optional parameter.  Name of the Management Server to connect to.  If not specified, the script will use an existing MS connection.  If none exists, it will try to connect to the local machine and attempt to load the OpsMgr Command Shell.  


*****Generate configuration file option*****  
**BulkOverride.ps1** *-AgentFQDN FQDN -MP ManagementPack* *[-MS FQDN][-FolderPath Path]*

[AgentFQDN] = Mandatory parameter.  The FQDN of the agent to generate the configuration file for.  
[MP] = Mandatory parameter.  Display name of the management pack where the overrides will be stored. This can either be an empty, unsealed management pack, or an existing unsealed MP with custom workflows and overrides, but the script will not create one if it does not already exist.    
[MS] = Optional parameter.  Name of the Management Server to connect to.  If not specified, the script will use an existing MS connection.  If none exists, it will try to connect to the local machine and attempt to load the OpsMgr Command Shell.  
[FolderPath] = Optional parameter.  The folder to save the raw CSV output to and use for generating overrides.  Default value is _C:\SCOMFiles\BulkOverride_.

#### Notes:
The script does not provide the option to disable rollup monitors by default.  If all subordinate unit monitors are disabled, the rollup monitor will be in an uninitialized state and does not need to be disabled.  If any subordinate unit monitors are not disabled, their state could never roll up to the host entity if any rollup monitors between the two were disabled.  

Aggregate monitors and dependency monitors are currently presented as potential overrides by the script. 

## View Script    
_(Right click and select 'Save Link As' to download)_    
https://github.com/RPesenko/OpsMgr-Scripts/blob/master/BulkOverride/BulkOverride.ps1


## Change Log  
1.0: Initial release  